---
interface Props {
  title?: string;
  description?: string;
}
const {
  title = "andarms",
  description = "Personal site of Adrian Manjarres (andarms)",
} = Astro.props as Props;
const year = new Date().getFullYear();
const currentPath = Astro.url.pathname;
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#0f0f0f" />
    <title>{title}</title>
    <meta name="description" content={description} />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="/style.css" />
    <script is:inline>
      // Prevent flash of wrong theme
      const savedTheme = localStorage.getItem("theme") || "dark";
      document.documentElement.setAttribute("data-theme", savedTheme);
    </script>
  </head>
  <body>
    <header class="site-header">
      <nav class="site-nav" aria-label="Site">
        <a class="brand" href="/">ã‚¢ãƒ³ãƒ‰ã‚¢ãƒ¼ãƒ ã‚º</a>
        <a
          href="/projects"
          class={currentPath.startsWith("/project") ? "active" : ""}>Projects</a
        >
        <a href="/blogs" class={currentPath.startsWith("/blog") ? "active" : ""}
          >Blogs</a
        >
        <button
          class="theme-toggle"
          id="theme-toggle"
          aria-label="Toggle theme"
        >
          <span class="sun-icon">ðŸŒž</span>
          <span class="moon-icon" style="display: none;">ðŸŒš</span>
        </button>
      </nav>
    </header>
    <main class="container" role="main">
      <slot />
    </main>
    <footer class="site-footer" role="contentinfo">
      <span>Made with ðŸ–¤ in Colombia</span>
      <img
        class="flag flag--co"
        src="/colombia.svg"
        width="20"
        height="14"
        alt="Colombia flag"
        loading="eager"
      />
      <span>Â© {year} @andarms</span>
    </footer>

    <script is:inline>
      // Theme toggle functionality
      document.addEventListener("DOMContentLoaded", function () {
        const themeToggle = document.getElementById("theme-toggle");
        const sunIcon = themeToggle?.querySelector(".sun-icon");
        const moonIcon = themeToggle?.querySelector(".moon-icon");

        // Check if elements exist before proceeding
        if (!themeToggle || !sunIcon || !moonIcon) {
          console.error("Theme toggle elements not found");
          return;
        }

        // Get current theme (already set by head script)
        const currentTheme =
          document.documentElement.getAttribute("data-theme") || "dark";
        updateThemeIcons(currentTheme);

        // Add both click and touch events for mobile compatibility
        themeToggle.addEventListener("click", toggleTheme);
        themeToggle.addEventListener("touchend", function (e) {
          e.preventDefault();
          toggleTheme();
        });

        function toggleTheme() {
          try {
            const currentTheme =
              document.documentElement.getAttribute("data-theme");
            const newTheme = currentTheme === "dark" ? "light" : "dark";

            document.documentElement.setAttribute("data-theme", newTheme);
            localStorage.setItem("theme", newTheme);
            updateThemeIcons(newTheme);
          } catch (error) {
            console.error("Error toggling theme:", error);
          }
        }

        function updateThemeIcons(theme) {
          try {
            if (theme === "light") {
              sunIcon.style.display = "none";
              moonIcon.style.display = "block";
            } else {
              sunIcon.style.display = "block";
              moonIcon.style.display = "none";
            }
          } catch (error) {
            console.error("Error updating theme icons:", error);
          }
        }
      });
    </script>

    <script
      is:inline
      async
      src="https://www.googletagmanager.com/gtag/js?id=G-ZEY5CE3BYD"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());
      gtag("config", "G-ZEY5CE3BYD");
    </script>
  </body>
</html>
